# 2015/02/11 SITZKRIEG

今回は回路図シリーズの解説その2です。その1をまだ読んでいない方はそちらから読むとよいかもしれません。

- 回路図シリーズ解説その1
    - [2015/02/10 PERPILOCUTIONIST](./perpilocutionist.md)


★Part 2: 2014/11/21 SITZKRIEG

[https://jojoingresswotd.github.io/2014/44/SITZKRIEG.html](https://jojoingresswotd.github.io/2014/44/SITZKRIEG.html)

今回も背景に回路図(図1)が入っています。IC1にI0～I2の3ビットの信号が入り、IC1の出力側Y0～Y7が7セグメントLEDにつながっています。そしてIC1の中にもじゃもじゃと入っているのが入力信号ですね。なお、入力信号の緑色のピクセルは、この記事のために私が着色したもので、元の画像では透明ピクセルになっていました。

3ビットの2進数を入力し、出力に8本の線がある、3ビットで表現できる2進数は0～7の8通りなのでちょうど合いますね。これは3ビットの数に対応する番号の出力線1本のみに1を出力し、その他は0を出力するという動作をするICに違いありません。このような回路をdemultiplexorとかdecoderと言います。74シリーズには74LS138があります[ [^1] ]。TK-80の拡張ボードを作ったり、Z80マイコンを自作した人はメモリ選択線の作成でお世話になりましたね。

この回路は、入力となる3ビットの数字に対応した、ひとつのセグメントだけを点灯させる回路ということになります。前回、セグメントにはa～gの名前がついていると解説しました。この回路ではa～gをIC1の出力線Y0～Y6に(つまり入力数値の0～6に)対応させ、小数点PをY7に対応させています。

```
　　０
　　━　
５┃６┃１
　　━　
４┃　┃２
　　━　
　　３	⑦←小数点は7
```

入力信号はIC1の中にもじゃもじゃ入っています。拡大してよく見ると(図2)、ピクセルが縦に3列並んでいます。ところどころ、横1行が白くなっているところが区切りでしょう。最初の白までの5行を取り出してみましょう。透明ピクセルを「■」、白ピクセルを「白」、なにもないところを「□」で表わしてみます

```
■□ ■□ ■□
■□ ■□ □■
□■ ■□ □■
□■ □■ ■□
□■ □■ □■
白□ 白□ 白□
```

回路の入力になるのですから、1行3ドットで3ビットの2進数になるはずです。■が左側右側どちらにあるかで1か0に対応しているのはすぐわかります。どっちが1でどっちが0でしょう? また、3列のどちらがMSB(most significant bit、上位桁、この場合はI2側)でしょう? これは上に取りだした5行だけでなく、全体を見て推理します。白ピクセルが全部左側にあることから、各列内で左が0で右が1、右の列がいちばん変わっていることから、3列の中では左からI2、I1、I0なのでしょう。そう思って見ると、上から下に向かって数字が大きくなっているのがわかります。これで多分間違いないですが、もし意味不明になったら後でここを違う解釈してやり直す必要があります。

上の5行を2進数と見なして順に書くと

```
■□ ■□ ■□ → 0
■□ ■□ □■ → 1
□■ ■□ □■ → 5
□■ □■ ■□ → 6
□■ □■ □■ → 7
白□ 白□ 白□
```

回路に入力して、一度に1セグメントずつ点灯したものを重ねると、こうなります。

```
 ＿
|＿|
 　 .
```

何か図形に見えますね。この調子で残りもやってみます。全部で15組あります。

```
 ＿   　   ＿   ＿   ＿   　   　   　   　   　   ＿   ＿   　   ＿   ＿
|＿| |＿  |＿| |＿   ＿| |＿   ＿  |　| |＿  |＿| |＿  |＿|  ＿|  　| |＿|
 　 .|＿   ＿|  ＿|  ＿|.|＿  |　  |＿| |＿  |　|  ＿|  　 .|＿|  　|. ＿|
```

うまく見えるかな? 一応自分の画面で表示したスクショも置いておきます(図3)。これを図形として文字に見えますか? 実は7セグメント表示でむりやり英文字を表現する方法もある[ [^2] ]のですが、今回はそれを知らなくてもなんとなく読めてしまうと思います。

`0tgs3truths0d7g`

gと9、sと5は英文字か数字かどっちにも見えますが、パスコードで数字が来るはずの位置には小数点がついているので、これで区別できるでしょう。

ところがこれはinvalid passcodeになってしまいました。実はパスコードの数字位置には0と1は来ないそうです。そしてゼロは7セグメントでは通常、下半分を使うか全体を使って書くはずで、上半分になっているのは違和感があります。きっとこれは出題者が間違えている(物語設定上は通信傍受の途中でデータが欠落している)のでしょう。上半分が四角になっている数字というと8か9があります。これを順に試してみた結果 `9tgs3truths9d7g` が正解でした。

出題から約24時間後にようやく正解できましたが、残念ながらFRでした。

次回は回路図シリーズの最終回、GNOMICを解説します。

★参考リンク

[^1]: [74LS138外観](https://www.tandyonline.co.uk/74ls138-3-to-8-line-decoder-demultiplexer.html) と [データシート](https://www.ti.com/lit/ds/symlink/sn74ls138.pdf)

[^2]: [7セグメントで英文字表示](https://ja.wikipedia.org/wiki/7%E3%82%BB%E3%82%B0%E3%83%A1%E3%83%B3%E3%83%88%E3%83%87%E3%82%A3%E3%82%B9%E3%83%97%E3%83%AC%E3%82%A4#.E6.95.B0.E5.AD.97.E4.BB.A5.E5.A4.96.E3.81.AE.E6.96.87.E5.AD.97.E3.81.AE.E8.A1.A8.E7.A4.BA)

<a href="/kaidoku/images/1agdcaa90qroi.png"><img width="200px" src="/kaidoku/images/1agdcaa90qroi.png"/><br/>図1: 回路図部分</a><br/>
<a href="/kaidoku/images/1agdcasibreqq.png"><img width="200px" src="/kaidoku/images/1agdcasibreqq.png"/><br/>図2: 入力信号拡大</a><br/>
<a href="/kaidoku/images/1agdcc37ml9ky.png"><img width="200px" src="/kaidoku/images/1agdcc37ml9ky.png"/><br/>図3: 答</a><br/>


----

[戻る](index.html)
