# 2015/02/12 GNOMIC

今回はJojo's Word of the Dayの回路図シリーズ解説その3、最終回です。その1、2をまだ読んでいない方はそちらから読むとわかりやすいと思います。

- 回路図シリーズ解説その1
    - [2015/02/10 PERPILOCUTIONIST](./perpilocutionist.md)
- 回路図シリーズ解説その2
    - [2015/02/11 SITZKRIEG](./sitzkrieg.md)

★Part 3: 2014/11/22 GNOMIC

[https://jojoingresswotd.github.io/2014/44/GNOMIC.html](https://jojoingresswotd.github.io/2014/44/GNOMIC.html)

今回の回路図(図1)は、4入力で8出力のIC1を使っています。CLKはclockという意味で、時間で変化する状態を持つ回路だとわかります。 `S_IN` のSは多分serialでしょう。IC1は、 `S_IN` からデータを1ビットずつ入力すると、それを記憶して8ビット分出力するという機能を持ち、shift registerと呼ばれる種類のものです。 `S_CLK` で、 `S_IN` のデータを読むタイミングを指示し、 `R_CLK` で指示したタイミングで8ビットを記憶して出力します。7400シリーズでは74LS594があります [ [^1] ] 。私は自分で使ったことはなかったので検索しました(最初74LS164かと思いましたが、164には `R_CLK` がありません)。

shift register 74LS594の動作はこんな感じです。

```
S_IN →□→□→□→□→□→□→□→□  ←S_CLKが来るごとに右にシフト(送る)
     　↓　↓　↓　↓　↓　↓　↓　↓
     　□　□　□　□　□　□　□　□  ←R_CLKのタイミングで記憶
     　↓　↓　↓　↓　↓　↓　↓　↓
     　Ａ　Ｂ　Ｃ　Ｄ　Ｅ　Ｆ　Ｇ　Ｈ
```

まず1段目として1ビットを記憶する箱が8つあって、ずらっとつながっています。 `S_CLK` のタイミングで各箱はひとつ左どなりの箱からデータをコピーして覚えます。 `S_CLK` が来るたびに左からコピーするので、全体としては左から右へデータを送っていくような動作になります。そして `R_CLK` が来ると、その時点で1段目の8つの箱に入っているデータを8ビットまとめて2段目の箱に記憶し、出力します。

つまり1本の信号線で時分割して送られてくるデータを、8ビットずつ8本の信号線で出力するのです。今回はその出力側が7セグメントLEDに接続されているので、セグメントのon/off情報8個分(7セグメント+小数点)を `S_IN` からシリアル入力するのでしょう。

入力データは背景画像の左端に縦に並んでいます。ちょっと長いので加工して3行にした画像を貼っておきます(図2)。1組が3列×8行になっていますね。この各列が信号線1本に対応するのは間違いないでしょう。そのうちのひとつが0、1、0、1と交互になっているので、 `S_CLK` に対応しそうです。これが0→1または1→0と変化するタイミングで `S_IN` を読み込み、シフトします。1組で同じ値になっている信号線は、組が変わるごとに変化していると見ることができ、これが `R_CLK` に対応するのでしょう。組ごとに `S_IN` 、 `S_CLK` 、 `R_CLK` の列が入れかえてありますが、これは作者のいじわるだと思います。回路図は4入力あるのでひとつ足りませんね。 `RST` (リセット)信号線は使わなくてよいのでしょう。8ビットレジスタなので、次の8行分を入力すると前のデータはあふれて消えます。

結果として `S_IN` の8つ分をまとめてLEDのセグメントに対応させればよく、最初の入力(図の上側)がHすなわち小数点、最後の入力がAすなわちaセグメントになりそうです。こう考えて出力を作ってみるとこうなります。

```
 ＿   　   　   　   ＿   　   　   　   　   　   　   ＿   　   ＿   　
|　|  　| |　| |＿|  ＿| |　| |＿  |＿| |　| |　|  　| |＿| |＿| |　| |＿|
|　|. ＿|.|＿| |＿  |＿ .|　|. 　   　|. ＿  |　|. ＿  |　 .|　|.|＿|.|　|.
```

あれっ、なんだか意味不明ですね。図形として左右や上下の反転をしても意味のあるものにはならなさそうです。前回数字を意味した小数点も、パスコード形式と比べて多すぎるので、信号の対応を間違ったと考えられます。入力信号を図の下から先に読むのかな?

```
 ＿   ＿   ＿   ＿   　   ＿   　   ＿   　   ＿   ＿   　   　   ＿   ＿
|＿| |＿  |＿|  ＿|  ＿  |＿   ＿  |＿|  　| |＿   ＿|  ＿| |＿  |＿  |＿
 ＿| |＿|. ＿|  ＿|.|　   ＿| |　|  　|  　|  ＿| |＿ .|＿| |＿| |　   ＿|.
```

ああこれなら読めます。数字の位置とパスコード形式を考えると左右は逆のようなので反転しましょう(図3)。

```
 ＿   ＿   　   　   ＿   ＿   　   ＿   　   ＿   　   ＿   ＿   ＿   ＿
|＿  |＿  |＿   ＿|  ＿| |＿   　| |＿|  ＿  |＿   ＿   ＿| |＿| |＿  |＿|
 ＿|.|　  |＿| |＿| |＿ . ＿|  　|  　| |　|  ＿| |　   ＿|. ＿| |＿|. ＿|
```

これで問題なく読める感じです。ん、でもこれって、IC1の出力A～HとLEDセグメントの対応を逆順にしたもののような。まあいいか。

`5fbd2siqnsr3g6g`

またまたinvalidでした。しかしどう見てもこれ、キーワードが「signs」でしょ。gとqは一番下のセグメントだけの違いなので `5fbd2signsr3g6g` を試してみます。そして正解でした。この日は日本時間で13時くらいに出題され、解けたのが19時くらいでしたがまだアイテムが取れました。作者がA～Hを逆順にしていて、またgをqにしていたのは、もしかしてわざと変えているのではなく素で間違えたんじゃないかと疑ってしまいますね。そのおかげでパスコードが長持ちしたのかもしれません。

回路図シリーズの出題は以上の3回です。この後も背景画像による出題が11月いっぱいくらい続きましたが、他のテーマのものでした。以上で全3回の回路図シリーズ解説は終わりです。

[^1]: [74LS594データシート](https://www.ti.com/lit/ds/symlink/sn74ls594.pdf)

<a href="/kaidoku/images/1ageowzapmq0i.png"><img width="200px" src="/kaidoku/images/1ageowzapmq0i.png"/><br/>図1: 回路図部分</a><br/>
<a href="/kaidoku/images/1ageoxclzmedu.png"><img width="200px" src="/kaidoku/images/1ageoxclzmedu.png"/><br/>図2: 信号部分</a><br/>
<a href="/kaidoku/images/1ageoxnxkwaz6.png"><img width="200px" src="/kaidoku/images/1ageoxnxkwaz6.png"/><br/>図3:7セグメント表示</a><br/>

----

[戻る](index.html)
